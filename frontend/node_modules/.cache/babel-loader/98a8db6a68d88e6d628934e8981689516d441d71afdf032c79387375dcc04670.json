{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.QueryClient = void 0;\nconst utils_1 = require(\"@cosmjs/utils\");\nclass QueryClient {\n  static withExtensions(cometClient, ...extensionSetups) {\n    const client = new QueryClient(cometClient);\n    const extensions = extensionSetups.map(setupExtension => setupExtension(client));\n    for (const extension of extensions) {\n      (0, utils_1.assert)((0, utils_1.isNonNullObject)(extension), `Extension must be a non-null object`);\n      for (const [moduleKey, moduleValue] of Object.entries(extension)) {\n        (0, utils_1.assert)((0, utils_1.isNonNullObject)(moduleValue), `Module must be a non-null object. Found type ${typeof moduleValue} for module \"${moduleKey}\".`);\n        const current = client[moduleKey] || {};\n        client[moduleKey] = {\n          ...current,\n          ...moduleValue\n        };\n      }\n    }\n    return client;\n  }\n  constructor(cometClient) {\n    this.cometClient = cometClient;\n  }\n  /**\n   * Performs an ABCI query to Tendermint without requesting a proof.\n   *\n   * If the `desiredHeight` is set, a particular height is requested. Otherwise\n   * the latest height is requested. The response contains the actual height of\n   * the query.\n   */\n  async queryAbci(path, request, desiredHeight) {\n    const response = await this.cometClient.abciQuery({\n      path: path,\n      data: request,\n      prove: false,\n      height: desiredHeight\n    });\n    if (response.code) {\n      throw new Error(`Query failed with (${response.code}): ${response.log}`);\n    }\n    if (!response.height) {\n      throw new Error(\"No query height returned\");\n    }\n    return {\n      value: response.value,\n      height: response.height\n    };\n  }\n}\nexports.QueryClient = QueryClient;","map":{"version":3,"names":["utils_1","require","QueryClient","withExtensions","cometClient","extensionSetups","client","extensions","map","setupExtension","extension","assert","isNonNullObject","moduleKey","moduleValue","Object","entries","current","constructor","queryAbci","path","request","desiredHeight","response","abciQuery","data","prove","height","code","Error","log","value","exports"],"sources":["../../src/queryclient/queryclient.ts"],"sourcesContent":[null],"mappings":";;;;;;AAEA,MAAAA,OAAA,GAAAC,OAAA;AA6BA,MAAaC,WAAW;EAwbf,OAAOC,cAAcA,CAC1BC,WAAwB,EACxB,GAAGC,eAAmD;IAEtD,MAAMC,MAAM,GAAG,IAAIJ,WAAW,CAACE,WAAW,CAAC;IAC3C,MAAMG,UAAU,GAAGF,eAAe,CAACG,GAAG,CAAEC,cAAc,IAAKA,cAAc,CAACH,MAAM,CAAC,CAAC;IAClF,KAAK,MAAMI,SAAS,IAAIH,UAAU,EAAE;MAClC,IAAAP,OAAA,CAAAW,MAAM,EAAC,IAAAX,OAAA,CAAAY,eAAe,EAACF,SAAS,CAAC,EAAE,qCAAqC,CAAC;MACzE,KAAK,MAAM,CAACG,SAAS,EAAEC,WAAW,CAAC,IAAIC,MAAM,CAACC,OAAO,CAACN,SAAS,CAAC,EAAE;QAChE,IAAAV,OAAA,CAAAW,MAAM,EACJ,IAAAX,OAAA,CAAAY,eAAe,EAACE,WAAW,CAAC,EAC5B,gDAAgD,OAAOA,WAAW,gBAAgBD,SAAS,IAAI,CAChG;QACD,MAAMI,OAAO,GAAIX,MAAc,CAACO,SAAS,CAAC,IAAI,EAAE;QAC/CP,MAAc,CAACO,SAAS,CAAC,GAAG;UAC3B,GAAGI,OAAO;UACV,GAAGH;SACJ;;;IAGL,OAAOR,MAAM;EACf;EAIAY,YAAmBd,WAAwB;IACzC,IAAI,CAACA,WAAW,GAAGA,WAAW;EAChC;EAEA;;;;;;;EAOO,MAAMe,SAASA,CACpBC,IAAY,EACZC,OAAmB,EACnBC,aAAsB;IAEtB,MAAMC,QAAQ,GAAG,MAAM,IAAI,CAACnB,WAAW,CAACoB,SAAS,CAAC;MAChDJ,IAAI,EAAEA,IAAI;MACVK,IAAI,EAAEJ,OAAO;MACbK,KAAK,EAAE,KAAK;MACZC,MAAM,EAAEL;KACT,CAAC;IAEF,IAAIC,QAAQ,CAACK,IAAI,EAAE;MACjB,MAAM,IAAIC,KAAK,CAAC,sBAAsBN,QAAQ,CAACK,IAAI,MAAML,QAAQ,CAACO,GAAG,EAAE,CAAC;;IAG1E,IAAI,CAACP,QAAQ,CAACI,MAAM,EAAE;MACpB,MAAM,IAAIE,KAAK,CAAC,0BAA0B,CAAC;;IAG7C,OAAO;MACLE,KAAK,EAAER,QAAQ,CAACQ,KAAK;MACrBJ,MAAM,EAAEJ,QAAQ,CAACI;KAClB;EACH;;AApfFK,OAAA,CAAA9B,WAAA,GAAAA,WAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}